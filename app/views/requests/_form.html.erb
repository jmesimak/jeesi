<%= form_for(@request) do |f| %>
  <% if @request.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@request.errors.count, "error") %> prohibited this request from being saved:</h2>

      <ul>
      <% @request.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :category %><br />
    <%= f.text_field :category %>
  </div>
    <p>Map</p>


  <div id="map"></div>
  <div id='actions'><a href='#'>Find me!</a></div>

    <script>

        function initMap() {
            var map = L.map('map').setView([51.505, -0.09], 13);

            L.tileLayer('http://{s}.tile.cloudmade.com/BC9A493B41014CAABB98F0471D759707/997/256/{z}/{x}/{y}.png', {
                maxZoom: 18,
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>'
            }).addTo(map);

            return map
/*            var options = {center : new L.LatLng(51.930156,7.189230), zoom : 7 };

            var osmUrl = 'http://{s}.tile.openstreetmap.org/mapnik_tiles/{z}/{x}/{y}.png',
                    osmAttribution = 'Map data &copy; 2012 OpenStreetMap contributors',
                    osm = new L.TileLayer(osmUrl, {maxZoom: 18, attribution: osmAttribution});

            var mapLayer = new L.TileLayer(osmUrl);

            this.map = new L.Map('map', options).addLayer(mapLayer);*/
        }

        function locateUser(map) {
            map.locate({setView : true});
        }

        var map = initMap();

        $('#actions').find('a').on('click', function() {
            locateUser(map);
        });
    </script>

  <div class="field">
    <%= f.label :xcord %><br />
    <%= f.text_field :xcord %>
  </div>
  <div class="field">
    <%= f.label :ycord %><br />
    <%= f.text_field :ycord %>
  </div>
  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>
  <div class="field">
    <%= f.label :description %><br />
    <%= f.text_area :description %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
