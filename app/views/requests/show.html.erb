<p id="notice"><%= notice %></p>


<p>
  <b>Category:</b>
  <%= @request.category %>
</p>

<p>
  <b>Title:</b>
  <%= @request.title %>
</p>

<p>
  <b>Description:</b>
  <%= @request.description %>
</p>

<div id="map"></div>

<script>
    function initMap() {

        var map = L.map('map').setView([<%= @request.ycord %>, <%= @request.xcord %>], 15);
        L.tileLayer('http://{s}.tile.cloudmade.com/BC9A493B41014CAABB98F0471D759707/997/256/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>'
        }).addTo(map);

        var greenIcon = L.icon({
            iconUrl: '/assets/leaf-green.png',
            shadowUrl: '/assets/leaf-shadow.png',

            iconSize:     [38, 95], // size of the icon
            shadowSize:   [50, 64], // size of the shadow
            iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
            shadowAnchor: [4, 62],  // the same for the shadow
            popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
        });

        var marker = L.marker([<%= @request.ycord %>, <%= @request.xcord %>], {icon: greenIcon}).addTo(map);
        // L.marker([<%= @request.ycord %>, <%= @request.xcord %>]).addTo(map);

        return map
    }
    var map = initMap();
</script>

</br>
<% @request.comments.each do |c| %>
    <%= c.content %> </br>
    by <%= c.user.email %> on <%= c.created_at %>  </br></br>
<% end %>

<%= render 'comments/form' %>

<%= link_to 'Edit', edit_request_path(@request) %> |
<%= link_to 'Back', requests_path %>
